<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mi Registro de Alfajores 2024</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');
        
        :root {
            --chocolate-dark: #3c2415;
            --chocolate-medium: #6b4423;
            --chocolate-light: #8b5a2b;
            --dulce-leche: #d4a574;
            --cream: #f5e6d3;
            --vanilla: #faf5f0;
            --caramel: #c8956d;
            --gold: #e6b800;
        }
        
        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, var(--vanilla) 0%, var(--cream) 100%);
        }
        
        .chocolate-dark { color: var(--chocolate-dark); }
        .bg-chocolate-dark { background-color: var(--chocolate-dark); }
        .chocolate-medium { color: var(--chocolate-medium); }
        .bg-chocolate-medium { background-color: var(--chocolate-medium); }
        .dulce-leche { color: var(--dulce-leche); }
        .bg-dulce-leche { background-color: var(--dulce-leche); }
        .caramel { color: var(--caramel); }
        .bg-caramel { background-color: var(--caramel); }
        
        .card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(196, 149, 109, 0.2);
            transition: all 0.3s ease;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(60, 36, 21, 0.15);
        }
        
        .rating-stars {
            color: var(--gold);
        }
        
        .form-input {
            border: 2px solid var(--dulce-leche);
            border-radius: 12px;
            padding: 12px 16px;
            transition: all 0.3s ease;
        }
        
        .form-input:focus {
            outline: none;
            border-color: var(--chocolate-medium);
            box-shadow: 0 0 0 3px rgba(107, 68, 35, 0.1);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--chocolate-medium), var(--chocolate-light));
            color: white;
            padding: 12px 24px;
            border-radius: 12px;
            font-weight: 600;
            transition: all 0.3s ease;
            border: none;
            cursor: pointer;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(60, 36, 21, 0.3);
        }
        
        .filter-btn {
            background: var(--cream);
            color: var(--chocolate-dark);
            border: 2px solid var(--dulce-leche);
            padding: 8px 16px;
            border-radius: 25px;
            font-weight: 500;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .filter-btn.active {
            background: var(--chocolate-medium);
            color: white;
            border-color: var(--chocolate-medium);
        }
        
        .alfajor-image {
            width: 100%;
            height: 200px;
            object-fit: cover;
            border-radius: 12px;
            background: var(--cream);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            color: var(--dulce-leche);
        }
        
        @media (max-width: 768px) {
            .grid-cols-auto {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body class="min-h-screen">
    <!-- Header -->
    <header class="bg-chocolate-dark text-white py-8 shadow-2xl">
        <div class="container mx-auto px-4">
            <div class="text-center">
                <h1 class="text-4xl md:text-5xl font-bold mb-2">
                    üß° Mi Registro de Alfajores 2024
                </h1>
                <p class="text-xl opacity-90">
                    Documentando cada dulce momento del a√±o
                </p>
            </div>
        </div>
    </header>

    <div class="container mx-auto px-4 py-8">
        <!-- Navigation Tabs -->
        <div class="flex flex-wrap justify-center gap-4 mb-8">
            <button onclick="showSection('form')" class="filter-btn active" id="tab-form">
                <i class="fas fa-plus mr-2"></i>Agregar Alfajor
            </button>
            <button onclick="showSection('gallery')" class="filter-btn" id="tab-gallery">
                <i class="fas fa-th-large mr-2"></i>Galer√≠a
            </button>
            <button onclick="showSection('stats')" class="filter-btn" id="tab-stats">
                <i class="fas fa-chart-bar mr-2"></i>Estad√≠sticas
            </button>
            <button onclick="showSection('favorites')" class="filter-btn" id="tab-favorites">
                <i class="fas fa-star mr-2"></i>Favoritos
            </button>
        </div>

        <!-- Add Alfajor Form -->
        <section id="form-section" class="mb-12">
            <div class="card rounded-2xl p-8 shadow-xl max-w-4xl mx-auto">
                <h2 class="text-3xl font-bold chocolate-dark text-center mb-8">
                    <i class="fas fa-cookie-bite mr-3"></i>Nuevo Alfajor
                </h2>
                
                <form id="alfajor-form" class="grid md:grid-cols-2 gap-6">
                    <div>
                        <label class="block text-sm font-semibold chocolate-dark mb-2">Fecha</label>
                        <input type="date" id="fecha" class="form-input w-full" required>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-semibold chocolate-dark mb-2">Momento del d√≠a</label>
                        <select id="momento" class="form-input w-full" required>
                            <option value="">Seleccionar...</option>
                            <option value="Desayuno">Desayuno</option>
                            <option value="Media ma√±ana">Media ma√±ana</option>
                            <option value="Almuerzo">Almuerzo</option>
                            <option value="Merienda">Merienda</option>
                            <option value="Cena">Cena</option>
                            <option value="Noche">Noche</option>
                        </select>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-semibold chocolate-dark mb-2">Nombre del alfajor</label>
                        <input type="text" id="nombre" class="form-input w-full" placeholder="Ej: Havanna, Cachafaz..." required>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-semibold chocolate-dark mb-2">Tipo de alfajor</label>
                        <select id="tipo" class="form-input w-full" required>
                            <option value="">Seleccionar...</option>
                            <option value="Negro">Negro</option>
                            <option value="Maicena">Maicena</option>
                            <option value="Chocolate">Chocolate</option>
                            <option value="Fruta">Fruta</option>
                            <option value="Nuez">Nuez</option>
                            <option value="Coco">Coco</option>
                            <option value="Otro">Otro</option>
                        </select>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-semibold chocolate-dark mb-2">Relleno</label>
                        <input type="text" id="relleno" class="form-input w-full" placeholder="Ej: Dulce de leche, mousse..." required>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-semibold chocolate-dark mb-2">Tama√±o</label>
                        <select id="tama√±o" class="form-input w-full" required>
                            <option value="">Seleccionar...</option>
                            <option value="Mini">Mini</option>
                            <option value="Chico">Chico</option>
                            <option value="Mediano">Mediano</option>
                            <option value="Grande">Grande</option>
                            <option value="Jumbo">Jumbo</option>
                        </select>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-semibold chocolate-dark mb-2">Precio ($)</label>
                        <input type="number" id="precio" class="form-input w-full" placeholder="0.00" step="0.01" min="0" required>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-semibold chocolate-dark mb-2">Puntuaci√≥n (0-10)</label>
                        <input type="number" id="puntuacion" class="form-input w-full" min="0" max="10" step="0.1" required>
                    </div>
                    
                    <div class="md:col-span-2">
                        <label class="block text-sm font-semibold chocolate-dark mb-2">Sabor (descripci√≥n corta)</label>
                        <input type="text" id="sabor" class="form-input w-full" placeholder="Ej: Dulce, equilibrado, muy chocolatoso..." required>
                    </div>
                    
                    <div class="md:col-span-2">
                        <label class="block text-sm font-semibold chocolate-dark mb-2">Comentarios</label>
                        <textarea id="comentarios" class="form-input w-full h-24" placeholder="Tus impresiones sobre este alfajor..."></textarea>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-semibold chocolate-dark mb-2">¬øVolver√≠a a comprar?</label>
                        <select id="volveria" class="form-input w-full" required>
                            <option value="">Seleccionar...</option>
                            <option value="S√≠">S√≠</option>
                            <option value="No">No</option>
                            <option value="Tal vez">Tal vez</option>
                        </select>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-semibold chocolate-dark mb-2">Foto del alfajor</label>
                        <input type="file" id="foto" class="form-input w-full" accept="image/*">
                    </div>
                    
                    <div class="md:col-span-2 text-center">
                        <button type="submit" class="btn-primary text-lg px-8 py-3">
                            <i class="fas fa-save mr-2"></i>Guardar Alfajor
                        </button>
                    </div>
                </form>
            </div>
        </section>

        <!-- Gallery Section -->
        <section id="gallery-section" class="mb-12 hidden">
            <div class="card rounded-2xl p-8 shadow-xl">
                <div class="flex flex-wrap justify-between items-center mb-6">
                    <h2 class="text-3xl font-bold chocolate-dark">
                        <i class="fas fa-th-large mr-3"></i>Galer√≠a de Alfajores
                    </h2>
                    <div class="flex flex-wrap gap-2">
                        <button onclick="exportData('excel')" class="btn-primary text-sm">
                            <i class="fas fa-file-excel mr-1"></i>Excel
                        </button>
                        <button onclick="exportData('pdf')" class="btn-primary text-sm">
                            <i class="fas fa-file-pdf mr-1"></i>PDF
                        </button>
                    </div>
                </div>
                
                <!-- Filters -->
                <div class="mb-6">
                    <div class="flex flex-wrap gap-4 mb-4">
                        <select id="filter-tipo" class="form-input" onchange="applyFilters()">
                            <option value="">Todos los tipos</option>
                        </select>
                        <select id="filter-momento" class="form-input" onchange="applyFilters()">
                            <option value="">Todos los momentos</option>
                        </select>
                        <select id="filter-puntuacion" class="form-input" onchange="applyFilters()">
                            <option value="">Todas las puntuaciones</option>
                            <option value="9-10">Excelente (9-10)</option>
                            <option value="7-8">Muy bueno (7-8)</option>
                            <option value="5-6">Bueno (5-6)</option>
                            <option value="0-4">Regular (0-4)</option>
                        </select>
                        <select id="filter-mes" class="form-input" onchange="applyFilters()">
                            <option value="">Todos los meses</option>
                        </select>
                    </div>
                    <div class="flex flex-wrap gap-2">
                        <button onclick="sortBy('fecha')" class="filter-btn">
                            <i class="fas fa-calendar mr-1"></i>Por fecha
                        </button>
                        <button onclick="sortBy('puntuacion')" class="filter-btn">
                            <i class="fas fa-star mr-1"></i>Por puntuaci√≥n
                        </button>
                        <button onclick="sortBy('precio')" class="filter-btn">
                            <i class="fas fa-dollar-sign mr-1"></i>Por precio
                        </button>
                    </div>
                </div>
                
                <div id="alfajores-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <!-- Alfajores will be displayed here -->
                </div>
            </div>
        </section>

        <!-- Statistics Section -->
        <section id="stats-section" class="mb-12 hidden">
            <div class="grid md:grid-cols-2 gap-8">
                <!-- General Stats -->
                <div class="card rounded-2xl p-8 shadow-xl">
                    <h3 class="text-2xl font-bold chocolate-dark mb-6">
                        <i class="fas fa-chart-line mr-3"></i>Estad√≠sticas Generales
                    </h3>
                    <div id="general-stats" class="space-y-4">
                        <!-- Stats will be populated here -->
                    </div>
                </div>
                
                <!-- Chart -->
                <div class="card rounded-2xl p-8 shadow-xl">
                    <h3 class="text-2xl font-bold chocolate-dark mb-6">
                        <i class="fas fa-chart-pie mr-3"></i>Distribuci√≥n por Tipo
                    </h3>
                    <canvas id="tipo-chart" width="400" height="400"></canvas>
                </div>
            </div>
        </section>

        <!-- Favorites Section -->
        <section id="favorites-section" class="mb-12 hidden">
            <div class="card rounded-2xl p-8 shadow-xl">
                <h2 class="text-3xl font-bold chocolate-dark text-center mb-8">
                    <i class="fas fa-trophy mr-3"></i>Los Mejores Alfajores del A√±o
                </h2>
                <div id="favorites-grid" class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <!-- Top alfajores will be displayed here -->
                </div>
            </div>
        </section>
    </div>

    <script>
        let alfajores = JSON.parse(localStorage.getItem('alfajores')) || [];
        let currentSort = 'fecha';
        let currentFilters = {};

        // Initialize the app
        document.addEventListener('DOMContentLoaded', function() {
            // Set today's date as default
            document.getElementById('fecha').valueAsDate = new Date();
            
            loadData();
            updateFilters();
            displayAlfajores();
            updateStats();
            displayFavorites();
        });

        // Form submission
        document.getElementById('alfajor-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const formData = new FormData();
            const fileInput = document.getElementById('foto');
            
            const alfajor = {
                id: Date.now(),
                fecha: document.getElementById('fecha').value,
                momento: document.getElementById('momento').value,
                nombre: document.getElementById('nombre').value,
                tipo: document.getElementById('tipo').value,
                relleno: document.getElementById('relleno').value,
                tama√±o: document.getElementById('tama√±o').value,
                precio: parseFloat(document.getElementById('precio').value),
                sabor: document.getElementById('sabor').value,
                comentarios: document.getElementById('comentarios').value,
                puntuacion: parseFloat(document.getElementById('puntuacion').value),
                volveria: document.getElementById('volveria').value,
                foto: null
            };
            
            // Handle image upload
            if (fileInput.files[0]) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    alfajor.foto = e.target.result;
                    saveAlfajor(alfajor);
                };
                reader.readAsDataURL(fileInput.files[0]);
            } else {
                saveAlfajor(alfajor);
            }
        });

        function saveAlfajor(alfajor) {
            alfajores.push(alfajor);
            localStorage.setItem('alfajores', JSON.stringify(alfajores));
            
            // Reset form
            document.getElementById('alfajor-form').reset();
            document.getElementById('fecha').valueAsDate = new Date();
            
            // Update displays
            updateFilters();
            displayAlfajores();
            updateStats();
            displayFavorites();
            
            // Show success message
            alert('¬°Alfajor guardado exitosamente! üß°');
        }

        function loadData() {
            const stored = localStorage.getItem('alfajores');
            if (stored) {
                alfajores = JSON.parse(stored);
            }
        }

        function showSection(section) {
            // Hide all sections
            document.querySelectorAll('[id$="-section"]').forEach(s => s.classList.add('hidden'));
            
            // Remove active class from all tabs
            document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
            
            // Show selected section
            document.getElementById(section + '-section').classList.remove('hidden');
            document.getElementById('tab-' + section).classList.add('active');
        }

        function updateFilters() {
            const tipos = [...new Set(alfajores.map(a => a.tipo))];
            const momentos = [...new Set(alfajores.map(a => a.momento))];
            const meses = [...new Set(alfajores.map(a => {
                const date = new Date(a.fecha);
                return date.toLocaleDateString('es', { month: 'long', year: 'numeric' });
            }))];

            updateSelectOptions('filter-tipo', tipos);
            updateSelectOptions('filter-momento', momentos);
            updateSelectOptions('filter-mes', meses);
        }

        function updateSelectOptions(selectId, options) {
            const select = document.getElementById(selectId);
            const currentValue = select.value;
            
            // Keep first option (all)
            const firstOption = select.children[0];
            select.innerHTML = '';
            select.appendChild(firstOption);
            
            options.forEach(option => {
                const optionElement = document.createElement('option');
                optionElement.value = option;
                optionElement.textContent = option;
                select.appendChild(optionElement);
            });
            
            select.value = currentValue;
        }

        function applyFilters() {
            currentFilters = {
                tipo: document.getElementById('filter-tipo').value,
                momento: document.getElementById('filter-momento').value,
                puntuacion: document.getElementById('filter-puntuacion').value,
                mes: document.getElementById('filter-mes').value
            };
            displayAlfajores();
        }

        function sortBy(criteria) {
            currentSort = criteria;
            displayAlfajores();
        }

        function displayAlfajores() {
            let filtered = alfajores.filter(alfajor => {
                if (currentFilters.tipo && alfajor.tipo !== currentFilters.tipo) return false;
                if (currentFilters.momento && alfajor.momento !== currentFilters.momento) return false;
                if (currentFilters.mes) {
                    const date = new Date(alfajor.fecha);
                    const mes = date.toLocaleDateString('es', { month: 'long', year: 'numeric' });
                    if (mes !== currentFilters.mes) return false;
                }
                if (currentFilters.puntuacion) {
                    const [min, max] = currentFilters.puntuacion.split('-').map(Number);
                    if (alfajor.puntuacion < min || alfajor.puntuacion > max) return false;
                }
                return true;
            });

            // Sort
            filtered.sort((a, b) => {
                if (currentSort === 'fecha') return new Date(b.fecha) - new Date(a.fecha);
                if (currentSort === 'puntuacion') return b.puntuacion - a.puntuacion;
                if (currentSort === 'precio') return b.precio - a.precio;
                return 0;
            });

            const grid = document.getElementById('alfajores-grid');
            grid.innerHTML = '';

            if (filtered.length === 0) {
                grid.innerHTML = '<div class="col-span-full text-center py-12"><p class="text-xl chocolate-medium">No se encontraron alfajores con estos filtros</p></div>';
                return;
            }

            filtered.forEach(alfajor => {
                const card = createAlfajorCard(alfajor);
                grid.appendChild(card);
            });
        }

        function createAlfajorCard(alfajor) {
            const card = document.createElement('div');
            card.className = 'card rounded-2xl p-6 shadow-lg';
            
            const stars = '‚òÖ'.repeat(Math.floor(alfajor.puntuacion)) + '‚òÜ'.repeat(10 - Math.floor(alfajor.puntuacion));
            const date = new Date(alfajor.fecha).toLocaleDateString('es');
            
            card.innerHTML = `
                <div class="alfajor-image mb-4">
                    ${alfajor.foto ? `<img src="${alfajor.foto}" alt="${alfajor.nombre}" class="alfajor-image">` : 'üß°'}
                </div>
                <h3 class="text-xl font-bold chocolate-dark mb-2">${alfajor.nombre}</h3>
                <div class="space-y-2 text-sm">
                    <p><span class="font-semibold">Fecha:</span> ${date}</p>
                    <p><span class="font-semibold">Momento:</span> ${alfajor.momento}</p>
                    <p><span class="font-semibold">Tipo:</span> ${alfajor.tipo}</p>
                    <p><span class="font-semibold">Relleno:</span> ${alfajor.relleno}</p>
                    <p><span class="font-semibold">Tama√±o:</span> ${alfajor.tama√±o}</p>
                    <p><span class="font-semibold">Precio:</span> $${alfajor.precio}</p>
                    <p><span class="font-semibold">Sabor:</span> ${alfajor.sabor}</p>
                    ${alfajor.comentarios ? `<p><span class="font-semibold">Comentarios:</span> ${alfajor.comentarios}</p>` : ''}
                    <p><span class="font-semibold">¬øVolver√≠a a comprar?:</span> ${alfajor.volveria}</p>
                </div>
                <div class="mt-4 flex justify-between items-center">
                    <div class="rating-stars text-lg">${stars}</div>
                    <div class="text-lg font-bold chocolate-medium">${alfajor.puntuacion}/10</div>
                </div>
            `;
            
            return card;
        }

        function updateStats() {
            if (alfajores.length === 0) {
                document.getElementById('general-stats').innerHTML = '<p class="text-center chocolate-medium">No hay datos para mostrar</p>';
                return;
            }

            const total = alfajores.length;
            const promedio = (alfajores.reduce((sum, a) => sum + a.puntuacion, 0) / total).toFixed(1);
            const precioPromedio = (alfajores.reduce((sum, a) => sum + a.precio, 0) / total).toFixed(2);
            
            // Most common type
            const tipos = alfajores.reduce((acc, a) => {
                acc[a.tipo] = (acc[a.tipo] || 0) + 1;
                return acc;
            }, {});
            const tipoMasComun = Object.keys(tipos).reduce((a, b) => tipos[a] > tipos[b] ? a : b);
            
            // Best alfajor
            const mejor = alfajores.reduce((best, current) => 
                current.puntuacion > best.puntuacion ? current : best
            );
            
            // Would buy again percentage
            const volveriaComprar = alfajores.filter(a => a.volveria === 'S√≠').length;
            const porcentajeVolveria = ((volveriaComprar / total) * 100).toFixed(1);

            document.getElementById('general-stats').innerHTML = `
                <div class="grid grid-cols-2 gap-4">
                    <div class="text-center p-4 bg-cream rounded-lg">
                        <div class="text-2xl font-bold chocolate-dark">${total}</div>
                        <div class="text-sm chocolate-medium">Total probados</div>
                    </div>
                    <div class="text-center p-4 bg-cream rounded-lg">
                        <div class="text-2xl font-bold chocolate-dark">${promedio}</div>
                        <div class="text-sm chocolate-medium">Puntuaci√≥n promedio</div>
                    </div>
                    <div class="text-center p-4 bg-cream rounded-lg">
                        <div class="text-2xl font-bold chocolate-dark">$${precioPromedio}</div>
                        <div class="text-sm chocolate-medium">Precio promedio</div>
                    </div>
                    <div class="text-center p-4 bg-cream rounded-lg">
                        <div class="text-2xl font-bold chocolate-dark">${porcentajeVolveria}%</div>
                        <div class="text-sm chocolate-medium">Volver√≠a a comprar</div>
                    </div>
                </div>
                <div class="mt-4 space-y-2">
                    <p><span class="font-semibold">Tipo m√°s probado:</span> ${tipoMasComun} (${tipos[tipoMasComun]} veces)</p>
                    <p><span class="font-semibold">Mejor alfajor:</span> ${mejor.nombre} (${mejor.puntuacion}/10)</p>
                </div>
            `;

            // Update chart
            updateChart();
        }

        function updateChart() {
            const ctx = document.getElementById('tipo-chart').getContext('2d');
            
            const tipos = alfajores.reduce((acc, a) => {
                acc[a.tipo] = (acc[a.tipo] || 0) + 1;
                return acc;
            }, {});

            new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: Object.keys(tipos),
                    datasets: [{
                        data: Object.values(tipos),
                        backgroundColor: [
                            '#3c2415', '#6b4423', '#8b5a2b', '#d4a574', 
                            '#c8956d', '#e6b800', '#f5e6d3', '#8b4513'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }

        function displayFavorites() {
            const favorites = alfajores
                .filter(a => a.puntuacion >= 8)
                .sort((a, b) => b.puntuacion - a.puntuacion)
                .slice(0, 6);

            const grid = document.getElementById('favorites-grid');
            grid.innerHTML = '';

            if (favorites.length === 0) {
                grid.innerHTML = '<div class="col-span-full text-center py-12"><p class="text-xl chocolate-medium">A√∫n no hay alfajores con puntuaci√≥n 8 o superior</p></div>';
                return;
            }

            favorites.forEach((alfajor, index) => {
                const card = createAlfajorCard(alfajor);
                card.classList.add('border-4', 'border-gold');
                
                // Add trophy for top 3
                if (index < 3) {
                    const trophy = document.createElement('div');
                    trophy.className = 'absolute -top-2 -right-2 w-8 h-8 bg-gold rounded-full flex items-center justify-center text-white font-bold';
                    trophy.textContent = index + 1;
                    card.style.position = 'relative';
                    card.appendChild(trophy);
                }
                
                grid.appendChild(card);
            });
        }

        function exportData(format) {
            if (alfajores.length === 0) {
                alert('No hay datos para exportar');
                return;
            }

            if (format === 'excel') {
                exportToExcel();
            } else if (format === 'pdf') {
                exportToPDF();
            }
        }

        function exportToExcel() {
            const headers = ['Fecha', 'Momento', 'Nombre', 'Tipo', 'Relleno', 'Tama√±o', 'Precio', 'Sabor', 'Comentarios', 'Puntuaci√≥n', 'Volver√≠a a comprar'];
            
            let csv = headers.join(',') + '\n';
            
            alfajores.forEach(alfajor => {
                const row = [
                    alfajor.fecha,
                    alfajor.momento,
                    `"${alfajor.nombre}"`,
                    alfajor.tipo,
                    `"${alfajor.relleno}"`,
                    alfajor.tama√±o,
                    alfajor.precio,
                    `"${alfajor.sabor}"`,
                    `"${alfajor.comentarios || ''}"`,
                    alfajor.puntuacion,
                    alfajor.volveria
                ];
                csv += row.join(',') + '\n';
            });
            
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'registro-alfajores-2024.csv';
            a.click();
            window.URL.revokeObjectURL(url);
        }

        function exportToPDF() {
            // Simple PDF export using print functionality
            const printWindow = window.open('', '_blank');
            
            let content = `
                <html>
                <head>
                    <title>Registro de Alfajores 2024</title>
                    <style>
                        body { font-family: Arial, sans-serif; margin: 20px; }
                        h1 { color: #3c2415; text-align: center; }
                        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
                        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
                        th { background-color: #d4a574; color: white; }
                        .stats { background-color: #f5e6d3; padding: 15px; margin: 20px 0; border-radius: 5px; }
                    </style>
                </head>
                <body>
                    <h1>üß° Mi Registro de Alfajores 2024</h1>
                    <div class="stats">
                        <h3>Estad√≠sticas Generales</h3>
                        <p><strong>Total probados:</strong> ${alfajores.length}</p>
                        <p><strong>Puntuaci√≥n promedio:</strong> ${(alfajores.reduce((sum, a) => sum + a.puntuacion, 0) / alfajores.length).toFixed(1)}</p>
                        <p><strong>Precio promedio:</strong> $${(alfajores.reduce((sum, a) => sum + a.precio, 0) / alfajores.length).toFixed(2)}</p>
                    </div>
                    <table>
                        <thead>
                            <tr>
                                <th>Fecha</th>
                                <th>Nombre</th>
                                <th>Tipo</th>
                                <th>Relleno</th>
                                <th>Precio</th>
                                <th>Puntuaci√≥n</th>
                                <th>Volver√≠a a comprar</th>
                            </tr>
                        </thead>
                        <tbody>
            `;
            
            alfajores.forEach(alfajor => {
                content += `
                    <tr>
                        <td>${new Date(alfajor.fecha).toLocaleDateString('es')}</td>
                        <td>${alfajor.nombre}</td>
                        <td>${alfajor.tipo}</td>
                        <td>${alfajor.relleno}</td>
                        <td>$${alfajor.precio}</td>
                        <td>${alfajor.puntuacion}/10</td>
                        <td>${alfajor.volveria}</td>
                    </tr>
                `;
            });
            
            content += `
                        </tbody>
                    </table>
                </body>
                </html>
            `;
            
            printWindow.document.write(content);
            printWindow.document.close();
            printWindow.print();
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'96b78575d5d03557',t:'MTc1NDU3NzU0NC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
